var e={d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{CallLimits:()=>p,callWithReducer:()=>c,clearAllCallReducerData:()=>S,clearCallReducerData:()=>d});var r={};e.r(r),e.d(r,{deepDispose:()=>u,disposeMaterials:()=>y});var a={};e.r(a),e.d(a,{deepMerge:()=>f,getObjectDiff:()=>b,patchObject:()=>M});var s={};e.r(s),e.d(s,{TimePattern:()=>_,formatTime:()=>h});var o={};e.r(o),e.d(o,{getUniqueId:()=>P});var l={};e.r(l),e.d(l,{absVector3:()=>x});var i={};e.r(i),e.d(i,{isPointInATriangle:()=>z,sign:()=>C,yFromTriangle:()=>j});const p={NO_LIMIT:-1,CALL_1_PER_SECONDS:1e3,CALL_15_PER_SECONDS:1e3/15,CALL_30_PER_SECONDS:1e3/30,CALL_45_PER_SECONDS:1e3/45,CALL_60_PER_SECONDS:1e3/60,CALL_120_PER_SECONDS:1e3/120};let n={};const c=({id:e,callback:t,callLimit:r,elapsed:a,callbackParam:s,forceCallCount:o=!1})=>{if(!a)return;n[e]||(n[e]={lastUpdate:-1,callCount:0});const l=()=>{s?t(s):t()};if(r!==p.NO_LIMIT)if(o){const t=Math.floor(a/(1e3*r));for(;-1===n[e].lastUpdate||t>n[e].callCount;)l(),n[e].lastUpdate+=r,n[e].callCount++;n[e].lastUpdate=a}else(-1===n[e].lastUpdate||a-n[e].lastUpdate>=r)&&(l(),n[e].lastUpdate=a);else l()},d=e=>delete n[e],S=()=>{n={}},y=e=>{if(e.isMaterial){const t=e;t.map?.dispose(),t.map=null,t.dispose()}else e.forEach(y)},u=e=>{const{isMesh:t,material:r,geometry:a}=e;t?(r&&(y(r),e.material=null),a&&(a.dispose(),e.geometry=null),e.parent?.remove(e)):e.children&&(e.children.forEach(u),e.parent?.remove(e))},M=(e,t,r={skippedProperties:[],applyToFirstObject:!1})=>{const a={};return Object.keys(e).forEach(s=>{r.skippedProperties&&r.skippedProperties.includes(s)||("object"==typeof e[s]&&e[s]&&t[s]&&!Array.isArray(e[s])?a[s]=M(e[s],t[s],r):(a[s]=0===t[s]?0:!1!==t[s]&&(t[s]||e[s]),r.applyToFirstObject&&(e[s]=a[s])))}),a},f=(e,t,r={skippedProperties:[],applyToFirstObject:!1})=>{const a={};return Array.from(new Set([...Object.keys(e||{}),...Object.keys(t||{})])).forEach(s=>{r.skippedProperties&&r.skippedProperties.includes(s)||("object"==typeof e?.[s]&&e?.[s]&&t?.[s]&&!Array.isArray(e[s])?a[s]=f(e[s],t[s],r):(a[s]=0===t?.[s]?0:!1!==t?.[s]&&(t?.[s]||e?.[s]),r.applyToFirstObject&&(e[s]=a[s])))}),a},b=(e,t,r={skippedProperties:[]})=>{const a={};return Object.keys(e).forEach(s=>{if(!r.skippedProperties||!r.skippedProperties.includes(s))if("object"==typeof e[s]&&e[s]&&t[s]&&!Array.isArray(e[s])){const o=b(e[s],t[s],r);Object.keys(o).length>0&&(a[s]=o)}else{const r=0===t[s]?0:t[s]||e[s];r!==e[s]&&(a[s]=r)}}),a},_={HH_MM_SS:"HH:MM:SS",MM_SS:"MM:SS",MM_SS_MS:"MM:SS.MS"},m=[{pattern:"HH",routine:({hours:e})=>String(e).padStart(2,"0")},{pattern:"MM",routine:({minutes:e})=>String(e).padStart(2,"0")},{pattern:"SS",routine:({seconds:e})=>String(e).padStart(2,"0")},{pattern:"MS",routine:({milliseconds:e})=>String(e).padStart(3,"0")}],h=(e,t)=>{const r=Math.floor(e%1e3),a=Math.floor(e/1e3%60),s=Math.floor(Math.floor(e/1e3/60)%60),o={hours:Math.floor(Math.floor(e/1e3/60)/60%24),minutes:s,seconds:a,milliseconds:r};let l=t;return m.forEach(({pattern:e,routine:t})=>l=l.replace(e,t(o))),l};let O=0;const P=()=>O++,x=e=>(e.x=Math.abs(e.x),e.y=Math.abs(e.y),e.z=Math.abs(e.z),e),C=(e,t,r)=>(e.x-r.x)*(t.z-r.z)-(t.x-r.x)*(e.z-r.z),z=(e,t,r,a)=>{const s=C(e,t,r),o=C(e,r,a),l=C(e,a,t);return!((s<0||o<0||l<0)&&(s>0||o>0||l>0))},j=(e,t,r,a)=>{const s=(r.x-t.x)*(a.y-t.y)-(a.x-t.x)*(r.y-t.y),o=(r.x-t.x)*(a.z-t.z)-(a.x-t.x)*(r.z-t.z),l=(r.z-t.z)*(a.y-t.y)-(a.z-t.z)*(r.y-t.y),i=(r.x-t.x)*(a.z-t.z)-(a.x-t.x)*(r.z-t.z);return t.y+s/o*(e.z-t.z)-l/i*(e.x-t.x)};export{t as CallbackUtils,r as DisposeUtils,i as GeomUtils,a as ObjectUtils,s as TimeUtils,o as TokenUtils,l as Vector3Utils};